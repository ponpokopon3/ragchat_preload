セキュリティ仕様書
１ 対象システムの前提
１．１ 本仕様書の目的
本仕様書は、対象Webサービスにおける情報セキュリティ対策の方針および具体的な機能仕様を明確にし、開発・運用におけるセキュリティ確保を目的とする。

１．２ 本仕様書の位置づけ
本仕様書は、システム開発におけるセキュリティ設計の基礎資料として位置づけられ、関連する設計書、運用手順書と連携して使用される。

１．３ 本仕様書の記載範囲
本仕様書は、Webサービスの開発・運用に関わるセキュリティ要件、機能仕様、運用項目を網羅する。対象範囲はアプリケーション、ミドルウェア、ネットワーク、端末、関連システムを含む。

２ 対象システムの前提
２．１ 適用される既存のセキュリティ方針
本システムは、企業の情報セキュリティ基本方針、ISMS（情報セキュリティマネジメントシステム）に準拠し、JIS Q 27001、NIST SP800シリーズ等の標準に基づく。

３ 対象システムの概要
３．１ システムの目的と機能概要
本Webサービスは、ユーザーに対して年金情報を提供するオンラインプラットフォームであり、認証、情報照会、通知機能を備える。

３．２ システムの特性
個人情報を扱うため高いセキュリティが求められる
公共性が高く、可用性・信頼性が重要
多数の外部連携が存在
３．３ システムの構成および対象範囲
Webアプリケーションサーバ
データベースサーバ
認証基盤
外部API連携モジュール
３．４ システムの構成要素
フロントエンド（HTML/JS）
バックエンド（Java/PHP等）
DB（PostgreSQL等）
認証サーバ（LDAP/OAuth）
ログ収集・監視ツール
３．５ 関連システムの概要
e-Gov連携システム
社内年金管理システム
通知配信システム（メール/SMS）
４ 対象システムのセキュリティ分類と脅威
４．１ システムのセキュリティ分類
４．１．１ システムで扱う情報・分類
個人識別情報（PII）
認証情報（ID/パスワード）
年金加入履歴・金額情報
４．１．２ セキュリティの保護対象
機密性：個人情報の漏洩防止
完全性：情報の改ざん防止
可用性：サービス停止の防止
４．２ システムの脅威（オンライン事業所年金情報サービス）
４．２．１ 脅威の実現ルート
外部攻撃（SQLインジェクション、XSS）
内部不正アクセス
マルウェア感染
４．２．２ アクター定義
一般ユーザー
管理者
外部攻撃者
開発・運用担当者
４．２．３ 想定する脅威
認証情報の漏洩
データベースの不正アクセス
サーバのDoS攻撃
改ざん・なりすまし
５ セキュリティ対策方針
５．１ セキュリティ対策方針
本システムでは、以下の基本方針に基づきセキュリティ対策を講じる。

予防重視：脅威の発生を未然に防ぐ設計と運用
多層防御：複数の防御手段を組み合わせたセキュリティ対策
最小権限の原則：必要最小限のアクセス権限の付与
監視と検知：リアルタイム監視とインシデント検知体制の構築
継続的改善：定期的な診断と対策の見直し
６ セキュリティ機能仕様
６．１ ネットワーク通信制御機能
６．１．１ ネットワーク分離方針
インターネット接続系と業務系ネットワークを物理的・論理的に分離
DMZを設置し、外部公開サーバと内部サーバの通信を制限
６．１．２ 他システムとの通信制御
API通信はIP制限とTLSによる暗号化を実施
通信ログを取得し、異常検知を行う
６．１．３ システム内の通信制御
内部通信はVPNまたはTLSで暗号化
ファイアウォールによるポート制限を実施
６．１．４ システム開発時のネットワーク分離方針
開発環境と本番環境を完全分離
開発者のアクセスは認証・監査ログ取得を必須とする
６．２ ファイル転送機能
６．２．１ ディスク連携
ファイル転送はSFTPまたはHTTPSを使用
転送ファイルはウイルススキャンを実施
６．２．２ 媒体連携
USB等の外部媒体使用は原則禁止
やむを得ない場合は暗号化と使用ログの取得を義務化
６．３ 識別／認証機能
６．３．１ システム内部における識別／認証
ユーザーIDとパスワードによる認証
多要素認証（MFA）を導入
ロールベースアクセス制御（RBAC）を採用
６．３．２ システム外部との通信における識別／認証
OAuth2.0またはOpenID Connectによる認証連携
外部API連携時はクライアント証明書を使用
６．３．３ パスワード情報
パスワードはSHA-256以上のハッシュで保存
定期変更（90日）と複雑性ルールを適用
パスワードリスト攻撃対策としてロックアウト機能を実装
６．４ 負荷分散・冗長化
Webサーバ、DBサーバはロードバランサーを介して冗長構成（Active-ActiveまたはActive-Standby）を採用
障害発生時には自動フェイルオーバーを実施
冗長化構成の監視と定期的な切替試験を実施
６．５ セキュリティ対策機能
６．５．１ パターンファイル更新
ウイルス対策ソフトのパターンファイルは自動更新を設定
更新失敗時は管理者へ通知
６．５．２ 通知
６．５．２．１ F-Secure Linux Security
リアルタイム保護と定期スキャンを実施
検知時はSyslog連携による通知
６．５．２．２ F-Secure Server Security
Windowsサーバ向けに導入
管理コンソールで一元管理
６．５．２．３ F-Secure Client Security
管理端末に導入し、ポリシーに基づく制御を実施
６．６ 監視・監査ログ取得機能
アクセスログ、操作ログ、認証ログを取得
SIEMによりログ分析と異常検知を実施
ログは改ざん防止のためWORMストレージに保存
６．７ 時刻同期機能
NTPサーバを用いて全システムの時刻を同期
時刻のずれが検知された場合はアラート通知
６．８ 故障検出機能
６．８．１ ノード死活監視機能設計およびSNMPトラップ監視機能
Zabbix等の監視ツールにより死活監視を実施
SNMPトラップによる障害通知を設定
６．８．２ プロセス監視機能および閾値監視機能
CPU、メモリ、ディスク使用率の閾値監視
プロセス停止時の自動再起動設定
６．９ アカウント、パスワード管理機能
アカウントは個人単位で発行し、共用禁止
パスワードは暗号化保存し、定期変更を強制
アカウントの棚卸しを定期的に実施
６．１０ アクセス制御機能
６．１０．１ アクセス制御製品を用いたアクセス制御
ファイアウォール、WAF、ID管理製品を導入し、アクセス制御を実施
６．１０．２ 特権ユーザへの権限昇格制限
sudo権限の使用はログ取得と承認制
特権操作は監査対象とする
６．１０．３ データベースのアクセス制御
DBユーザーごとに権限を細分化
アプリケーション経由以外の直接アクセスを制限
６．１１ 暗号化機能
通信はTLS1.2以上を使用
保存データはAES256で暗号化
鍵管理はHSMまたはクラウドKMSを使用
６．１２ 個人情報の暗号化
６．１２．１ データベースの暗号化ポリシー
個人情報項目はカラム単位で暗号化
暗号化対象は設計書に明記
６．１２．２ 復号設定
復号は認証済みユーザーのみ可能
復号ログを取得し、監査対象とする
６．１２．３ バックアップファイルの暗号化設計
バックアップは暗号化ZIPまたはAES256形式で保存
復号鍵は別媒体で管理
６．１３ 改ざん検知機能
６．１３．１ Webページにおける改ざん検知
ファイルハッシュによる改ざん検知を定期実施
改ざん検知時は即時通知と自動復旧を実施
６．１４ バックアップ／復旧機能
DB、ログ、システム構成ファイルの定期バックアップ
バックアップは世代管理し、遠隔地保管
復旧手順書を整備し、定期的なリストア試験を実施
６．１５ セキュリティコーディング
OWASP Top 10に基づくセキュアコーディングを実施
静的解析ツールによるコードレビューを実施
６．１６ 記憶装置の暗号化機能
サーバのHDD/SSDはOSレベルで暗号化（BitLocker, LUKS等）
暗号化鍵はセキュアな領域に保存
６．１７ 端末における情報保護（ソフトウェア、端末ローカルポリシー）
管理端末にはDLP（情報漏洩防止）ソフトを導入
ローカル保存禁止、スクリーンショット制限を設定
６．１８ 名前解決
DNSは内部専用サーバを使用し、外部アクセスを制限
DNSキャッシュポイズニング対策としてDNSSECを導入
６．１９ e-Gov連携におけるセキュリティ要件
e-Govとの通信は専用VPNまたは閉域網を使用
通信内容は暗号化し、認証は電子証明書を使用
連携仕様書に基づくセキュリティ要件を遵守
７ セキュリティ運用項目
７．１ ウイルスパターンファイル更新運用
ウイルス対策ソフトのパターンファイルは毎日自動更新
更新失敗時は管理者に通知し、手動更新を実施
更新履歴はログとして保存し、月次で確認
７．２ セキュリティ侵害時の対応
７．２．１ セキュリティ侵害時の連絡体制・対応方針
インシデント発生時は即時にCSIRTへ報告
初動対応、影響範囲の特定、暫定対策、恒久対策の順に対応
関係者への報告と再発防止策の策定を実施
７．３ ソフトウェアおよびハードウェアの管理
７．３．１ 導入ソフトウェアおよびハードウェアのセキュリティ脆弱性に関する予防保守
ベンダー情報を定期確認し、脆弱性情報を収集
重大な脆弱性には即時対応
７．３．１．１ セキュリティパッチ適用
月次でパッチ適用を実施
影響評価後に本番環境へ展開
７．３．１．２ 更新プログラム配信運用
WSUS等を用いて一元管理
配信履歴と適用状況を記録
７．３．２ 情報セキュリティ水準低下の防止
定期的なセキュリティレビューを実施
運用ルールの遵守状況を監査
７．４ 監視・監査ログ取得運用
ログ取得は24時間365日体制
SIEMによる自動分析とアラート通知
月次でログレビューを実施
７．５ 故障検出運用
７．５．１ システム監視
死活監視、リソース監視、プロセス監視を統合管理
障害発生時は自動通知と一次対応手順に従う
７．６ アカウント、パスワード管理運用
７．６．１ 個人アカウントの管理
アカウント発行は申請・承認制
利用終了時は即時削除
７．６．１．１ 運用管理業者アカウントの管理
業者アカウントは期間限定で発行
利用履歴を記録し、監査対象とする
７．６．２ 共用アカウントの管理
原則共用アカウントは禁止
やむを得ない場合は使用ログ取得を義務化
７．６．２．１ 共有アカウントパスワード更新
月次でパスワード変更を実施
変更履歴を記録し、関係者に通知
７．７ 情報の分類および管理
情報資産を機密性に応じて分類（高・中・低）
分類に応じたアクセス制御と保管方法を適用
７．８ 媒体管理運用
外部媒体の持ち込み・持ち出しは申請・承認制
使用履歴を記録し、定期的に棚卸しを実施
７．９ システムの物理的対策と入退管理
７．９．１ マシン室における対策
入退室管理システムを導入（ICカード、監視カメラ）
記録は6ヶ月以上保管
７．９．２ マシン室外における対策（集中操作室を含む）
操作室は施錠管理し、入室は認証制
操作ログを取得し、監査対象とする
７．９．３ 瞬断・停電対策
UPSおよび非常用電源を設置
定期的な動作確認を実施
７．１０ 情報システム関連文書の整備
セキュリティ仕様書、運用手順書、障害対応手順書などの文書を整備
文書はバージョン管理し、改訂履歴を記録
年次で文書レビューを実施し、最新状態を維持
７．１１ 不要サービスの停止
使用していないサービス・ポートはすべて停止
定期的なサービス一覧の棚卸しを実施
新規サービス導入時はセキュリティレビューを実施
７．１２ 改ざん検知運用
Webページ、設定ファイル、ログファイルに対して改ざん検知を実施
改ざん検知ツール（Tripwire等）を導入
検知時は即時通知と復旧対応を実施
７．１３ バックアップ／復旧運用
７．１３．１ DBデータバックアップリストア（一次リストア）
毎日バックアップを取得し、1週間分を保持
リストア手順書に基づき、月次で復旧試験を実施
７．１３．２ ログバックアップリストア（一次リストア）
ログは日次でバックアップし、WORMストレージに保存
リストア手順を整備し、監査対応可能とする
７．１３．３ システムバックアップリストア（一次リストア）
OS、ミドルウェア、設定ファイルを含むバックアップを週次で取得
仮想環境での復旧試験を実施
７．１３．４ LTOリストア（二次リストア）
長期保管用にLTOテープを使用
年次でリストア試験を実施し、媒体の健全性を確認
７．１３．５ 災害時用バックアップ
遠隔地に災害対策用バックアップを保管
災害時の復旧手順を整備し、訓練を実施
７．１３．５．１ バックアップ媒体の作成
暗号化された媒体を作成し、保管場所を分散
媒体管理台帳を整備
７．１３．５．２ ログファイルの取得
災害時対応用に重要ログを別途取得
保管期間は最低1年間とする
７．１３．６ 災害時用リストア
災害時の復旧手順に基づき、優先度順にリストアを実施
復旧状況は関係者に報告
７．１４ プライバシー保護運用
個人情報の取り扱いは法令（個人情報保護法）に準拠
利用目的の明示、取得・保管・廃棄のルールを整備
プライバシーポリシーを公開し、ユーザーに周知
７．１５ システムの運用・保守時のセキュリティ対策運用
７．１５．１ ソフトウェアの運用・保守時のセキュリティ対策運用
保守作業は事前申請・承認制
作業ログを取得し、監査対象とする
７．１５．２ ハードウェアの運用・保守時のセキュリティ対策運用
機器交換・増設時は資産管理台帳に記録
作業者の身元確認と入退室管理を徹底
７．１６ システムの更改・廃棄時のセキュリティ対策運用
７．１６．１ ソフトウェアの更改・廃棄時のセキュリティ対策
更改時はセキュリティレビューを実施
廃棄時はライセンス情報の削除と記録保管
７．１６．２ ハードウェアの更改・廃棄時のセキュリティ対策
廃棄前に記憶媒体の完全消去（物理破壊または専用ツール）
廃棄証明書を取得し、保管
７．１７ セキュリティ診断の実施
年次で脆弱性診断（Webアプリ、ネットワーク）を実施
外部診断業者による第三者評価を受ける
診断結果に基づき、改善計画を策定
７．１８ システム利用に係る規程の整備
利用者向けに情報セキュリティ規程を整備
規程はイントラネットで公開し、定期的に教育を実施
違反時の対応方針を明記
７．１９ 鍵・証明書の管理運用
７．１９．１ 証明書の管理
サーバ証明書は有効期限を管理し、更新スケジュールを整備
証明書の発行・更新履歴を記録
７．１９．１．１ 証明書更新運用
有効期限の1ヶ月前に更新を実施
更新後は動作確認と関係者への通知を実施
７．１９．２ 鍵の管理
秘密鍵はHSMまたは暗号化ストレージで保管
鍵の使用履歴を記録し、監査対象とする
７．１９．２．１ DB秘密鍵入替え運用
半年ごとに鍵を更新
更新後はDB接続確認を実施
７．１９．２．２ SSH鍵入替え運用
管理者のSSH鍵は年次で更新
公開鍵はサーバに登録し、旧鍵は削除
７．１９．２．３ 電子署名の証明書、秘密鍵入替え運用
電子署名用の鍵は有効期限に応じて更新
更新後は署名検証試験を実施
